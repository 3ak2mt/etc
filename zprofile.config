#!/usr/bin/env bash
# ~/.zprofile
# Description : Lean, keyboard-optimized shell profile for login shells
# Author      : makmat
# Date        : 2025-12-02
# Version     : 1.0

set -euo pipefail
IFS=$'\n\t'

# ------------------------------
# Core environment
# ------------------------------
export PATH="$HOME/bin:$HOME/.local/bin:$PATH"
export MANPATH="${MANPATH:-/usr/share/man}"
export EDITOR="${EDITOR:-nvim}"
export BROWSER="${BROWSER:-elinks}"
export WWW_HOME="${WWW_HOME:-https://duckduckgo.com}"
export LFS="${LFS:-/mnt/LFS}"
export TMOUT="${TMOUT:-600}"   # automatic logout after inactivity (seconds)

# ------------------------------
# Perl (local::lib)
# ------------------------------
if command -v perl >/dev/null 2>&1; then
    export PATH="$HOME/perl5/bin:$PATH"
    export PERL5LIB="$HOME/perl5/lib/perl5${PERL5LIB:+:$PERL5LIB}"
    export PERL_LOCAL_LIB_ROOT="$HOME/perl5${PERL_LOCAL_LIB_ROOT:+:$PERL_LOCAL_LIB_ROOT}"
    export PERL_MB_OPT="--install_base $HOME/perl5"
    export PERL_MM_OPT="INSTALL_BASE=$HOME/perl5"
fi

# ------------------------------
# TeX Live (2025)
# ------------------------------
if [ -d "/usr/local/texlive/2025" ]; then
    export PATH="/usr/local/texlive/2025/bin/x86_64-linux:$PATH"
    export INFOPATH="/usr/local/texlive/2025/texmf-dist/doc/info${INFOPATH:+:$INFOPATH}"
    export MANPATH="/usr/local/texlive/2025/texmf-dist/doc/man:/usr/local/man${MANPATH:+:$MANPATH}"
fi

# ------------------------------
# Interactive shell detection
# ------------------------------
# Source .zshrc only for interactive shells
if [[ $- == *i* ]]; then
    [ -f "$HOME/.zshrc" ] && source "$HOME/.zshrc"
fi
